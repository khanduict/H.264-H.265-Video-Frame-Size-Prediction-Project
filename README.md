# H.264-H.265-Video-frame-size-prediction-project
As video has become the dominant type of traffic over wired and wireless networks, the efficient transmission of video streams is of paramount importance. Hence, especially for wireless networks, the optimum utilisation of the available bandwidth while preserving the usersâ€™ Quality of Service and Quality of Experience requirements is crucial. Towards this goal, the accurate prediction of upcoming video frame sizes can play a significant role. This work focuses on achieving such an accurate prediction for videos encoded with H.264 and H.265, which are the major state-of-the-art standards based on their current market share. Unlike previous studies, we use single-step and multi-step approaches to capture the long-range dependence and short-range dependence properties of variable bit rate video traces through neural networks-based modeling. We evaluate the accuracy of Long Short Term Memory, Convolutional Neural Networks and Sequence-to-Sequence models and compare them with existing approaches. Our models show significantly higher accuracy for a variety of videos. 
# Dataset
In this study we focus on videos encoded with H.264 and H.265 high efficiency video coding (HEVC) compression standards. The video traces corresponding to all H.264  and H.265 video traffic and quality characteristics presented in this section are available from the video trace library http://trace.eas.asu.edu/h264/ and http://trace.eas.asu.edu/videotraces2/h265/ to facilitate their usage in communication and networking studies.  H.264 is currently one of the most used video coding standards as it covers a huge range of applications like video conferencing, mobile services, and HD video storage [1]. In addition, H.265 aim to achieve the same video quality at lower bit rates. The two basic structural features that H.264 and H.265 encoders share in common are the three types of frames (I, P B), the periodic structure in which video frames are encoded and the pattern in which these frames are generated. The periodic structure is called a Group of Pictures (GoP). Each video frame is either intra-coded (I-frame), forward predictive coded (P-frame) with motion compensated prediction form the preceding I or P frame, or bi-directionally predictive coded (B-frame) according to its position in a group of pictures (GoP) structure.

Figure 1 shows an encoded sequence IBBBPBBBPBBBPBBBI of the GoP comprising of 16 frames (G16B3) with 1 I-frame, 3 P-frames and 12 B-frames. The first frame is encoded as an I-frame. Frames B-1, B-2 and B-3 are B-frames and cannot be encoded right away because they are waiting for the future P-frame. Therefore, they are put in the buffer. When frame P-4 arrives at the encoder, it is inter-encoded (unidirectional) with the first frame (I-frame) as a reference. Now that the P-frame has been encoded, the frames B-1, B-2 and B-3 which are bidirectional need references in the past and in the future, can be encoded. Thus, B-frames are constructed based on the reference frames namely, the P and I-frames.
<img width="417" alt="image" src="https://user-images.githubusercontent.com/38637722/179394532-63ab150e-1d8b-403a-8597-d8d7ae87e605.png">

Figure 1 shows an encoded sequence IBBBPBBBPBBBPBBBI of the GoP comprising of 16 frames (G16B3) with 1 I-frame, 3 P-frames and 12 B-frames. The first frame is encoded as an I-frame. Frames B-1, B-2 and B-3 are B-frames and cannot be encoded right away because they are waiting for the future P-frame. Therefore, they are put in the buffer. When frame P-4 arrives at the encoder, it is inter-encoded (unidirectional) with the first frame (I-frame) as a reference. Now that the P-frame has been encoded, the frames B-1, B-2 and B-3 which are bidirectional need references in the past and in the future, can be encoded. Thus, B-frames are constructed based on the reference frames namely, the P and I-frames. 
B-frames occupy the largest number of frames in H.264 group of pictures (GoP) as shown in Figure 2. In addition, the trace of B-frames is observed to be burstier than other frames which implies that the bandwidth allocation of B-frames is more challenging than the other frame types [3]. On the other hand, B-frames are considered least important as compared to I-frame and P-frames and dropping the same will not have much impact on the performance as the frames transmitted following a B-frame is not dependent on that frame. In addition, B-frames contain only temporal information and their loss can only cause motion artifacts which may be difficult to notice unless the loss rates are high.

Figure 3 illustrates the delay analysis and transmitted sequence of classical G16B3 frame with IBBBPBBBPBBBPBBBI GoP pattern. The decoder needs both the preceding I and P-frame and the succeeding P and I-frame for decoding a B-frame. The encoder emits the frames in the order IPBBBPBBBPBBBI and, the display sequence is displayed in the order IBBBPBBBPBBBPBBB.
<img width="293" alt="image" src="https://user-images.githubusercontent.com/38637722/179394402-c0e78554-3c9e-44df-b193-2023fb029f48.png">




